<!-- HTML header for doxygen 1.9.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<!-- favicon -->
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ManiaMap: ManiaMap</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<!-- ... other metadata & script includes ... -->
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="ManiaMap.png"/></td>
  <td id="projectalign">
   <div id="projectname">ManiaMap
   </div>
   <div id="projectbrief">Graph-based procedural generation of metroidvania style maps.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">ManiaMap </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p ><a class="anchor" id="md__github_workspace_README"></a> <a href="https://github.com/mpewsey/ManiaMap/actions/workflows/tests.yml"><img src="https://github.com/mpewsey/ManiaMap/actions/workflows/tests.yml/badge.svg?event=push" alt="Tests" style="pointer-events: none;" class="inline"/></a> <a href="https://mpewsey.github.io/ManiaMap"><img src="https://github.com/mpewsey/ManiaMap/actions/workflows/docs.yml/badge.svg?event=push" alt="Docs" style="pointer-events: none;" class="inline"/></a> <a href="https://codecov.io/gh/mpewsey/ManiaMap"><img src="https://codecov.io/gh/mpewsey/ManiaMap/branch/main/graph/badge.svg?token=Q1LDU83FAQ" alt="codecov" style="pointer-events: none;" class="inline"/></a> <a href="https://www.nuget.org/packages/MPewsey.ManiaMap/"><img src="https://img.shields.io/nuget/v/MPewsey.ManiaMap?label=NuGet" alt="NuGet" class="inline"/></a></p>
<h1><a class="anchor" id="autotoc_md3"></a>
About</h1>
<p >This package allows for the creation of procedurally generated metroidvania style layouts from user-defined level layout graphs and room templates. The resulting layouts can be used in games, such as those of the rouge-like genre, or to render maps, such as that shown below.</p>
<p ><img src="https://user-images.githubusercontent.com/23442063/158001876-cb3962a8-9826-44e9-bb19-a5779e3f99d6.png" alt="BigMap" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md4"></a>
Features</h1>
<ul>
<li>Single and multi-layer 2D room layout generation.</li>
<li>Graph-based procedural generation.</li>
<li>Specification of room connection constraints by defining door directions and matching door codes.</li>
<li>Rendering of generated layouts to image files using built-in or custom map tiles.</li>
<li>Procedural distribution of collectables throughout layout.</li>
<li>Supports .NET Standard 2.0.</li>
<li>Works with Windows, Mac, and Linux.</li>
</ul>
<h1><a class="anchor" id="autotoc_md5"></a>
Layout Generator Example</h1>
<p >The following subsections outline how to use the <code>LayoutGenerator</code> class to generate a room layout.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Step 1: Create Room Templates</h2>
<p >The generator creates rooms by pulling from user-defined room templates. Room templates consist of a 2D array of cells, that may be empty (a null value) or filled. Each cell includes the possible door connections (north, south, east, west, top, and/or bottom) that can be made from that cell to other rooms. Furthermore, each door includes a door code, which requires a match in another template for a connection to be made, as well as a traversal type, such the door being one-way or two-way.</p>
<p >Depending on how much variety you want to be included in your layout, one or more templates are required by the generator. The following code provides an example for the creation of a simple 3x3 square room template. In it, a series of cells are created and have doors set to them via directional characters ("N" = North, "S" = South, etc.). The cells are then assigned to a 2D array to create the geometry of the layout. Finally, these cells are passed to the <code>RoomTemplate</code> initializer, along with a unique ID, to create the room template.</p>
<div class="fragment"><div class="line">{RoomTemplate.cs} </div>
<div class="line">var o = Cell.New;</div>
<div class="line">var a = Cell.New.SetDoors(&quot;WN&quot;, Door.TwoWay);</div>
<div class="line">var b = Cell.New.SetDoors(&quot;N&quot;, Door.TwoWay);</div>
<div class="line">var c = Cell.New.SetDoors(&quot;NE&quot;, Door.TwoWay);</div>
<div class="line">var d = Cell.New.SetDoors(&quot;W&quot;, Door.TwoWay);</div>
<div class="line">var e = Cell.New.SetDoors(&quot;E&quot;, Door.TwoWay);</div>
<div class="line">var f = Cell.New.SetDoors(&quot;WS&quot;, Door.TwoWay);</div>
<div class="line">var g = Cell.New.SetDoors(&quot;S&quot;, Door.TwoWay);</div>
<div class="line">var h = Cell.New.SetDoors(&quot;SE&quot;, Door.TwoWay);</div>
<div class="line"> </div>
<div class="line">var cells = new Cell[,]</div>
<div class="line">{</div>
<div class="line">    { a, b, c },</div>
<div class="line">    { d, o, e },</div>
<div class="line">    { f, g, h },</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">var roomTemplate = new RoomTemplate(id: 1, name: &quot;Square&quot;, cells);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md7"></a>
Step 2: Assign Room Templates to Template Groups</h2>
<p >Once some room template have been defined, they must be added to one or more room template groups, which can be referenced by name later. This is accomplished by simply adding them to a <code>TemplateGroups</code> object:</p>
<div class="fragment"><div class="line">{TemplateGroups.cs} </div>
<div class="line">var templateGroups = new TemplateGroups();</div>
<div class="line">templateGroups.Add(&quot;Default&quot;, roomTemplate);</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md8"></a>
Step 3: Create a Layout Graph</h2>
<p >To provide a designed feel to generated layouts, the generator uses a room layout graph as the basis for generating layouts. The layout graph consists of nodes, representing rooms, and edges, representing door connections between rooms. Ultimately, the layout graph contains information to help guide the features of a room layout. Each graph element can be assigned one or more room template groups (created in Step 2) from which room templates can be drawn for that location. Z (layer) values can also be assigned to elements to create a multi-level room layout. In addition, properties such as names and colors can be assigned that will be passed on to the generated rooms, allowing for their use elsewhere in a game or other application.</p>
<p >In the below example, the graph shown in the image is created by adding edges to a graph. In the process, the nodes, representing rooms, are automatically created. Afterwards, the code loops over all of the created nodes and assigns a "Default" template group to them, from which room templates will be drawn by the generator.</p>
<div class="fragment"><div class="line">{LayoutGraph.cs} </div>
<div class="line">var graph = new LayoutGraph(id: 1, name: &quot;ExampleGraph&quot;);</div>
<div class="line"> </div>
<div class="line">// Define edges between nodes. Nodes not already in graph will automatically be created.</div>
<div class="line">graph.AddEdge(0, 1);</div>
<div class="line">graph.AddEdge(1, 2);</div>
<div class="line">graph.AddEdge(0, 3);</div>
<div class="line">graph.AddEdge(0, 4);</div>
<div class="line">graph.AddEdge(0, 5);</div>
<div class="line"> </div>
<div class="line">// Add &quot;Default&quot; template group to nodes.</div>
<div class="line">foreach (var node in graph.GetNodes())</div>
<div class="line">{</div>
<div class="line">    node.TemplateGroup = &quot;Default&quot;;</div>
<div class="line">}</div>
</div><!-- fragment --><p ><img src="https://user-images.githubusercontent.com/23442063/153694050-f653f3df-8170-4a2e-bd05-8f35083ccfef.png" alt="Example Layout Graph" class="inline"/></p>
<h2><a class="anchor" id="autotoc_md9"></a>
Step 4: Run the Layout Generator</h2>
<p >To create repeatable layouts, a random seed is used by the layout generator. To generate a room layout, simply select a seed and pass your layout graph and room template groups to the <code>LayoutGenerator</code>, as shown below. In the example, a map of the layout is also rendered and saved using the <code>LayoutMap</code> class. For this instance, the default built-in tiles are used. However, custom tiles can also be specified by the user.</p>
<div class="fragment"><div class="line">{LayoutGenerator.cs} </div>
<div class="line">var seed = new RandomSeed(12345);</div>
<div class="line">var generator = new LayoutGenerator();</div>
<div class="line">var layout = generator.Generate(layoutId: 1, graph, templateGroups, seed);</div>
<div class="line"> </div>
<div class="line">// Render map and save it to file</div>
<div class="line">var map = new LayoutMap(layout);</div>
<div class="line">map.SaveImage(&quot;Map.png&quot;);</div>
</div><!-- fragment --><p ><img src="https://user-images.githubusercontent.com/23442063/153345310-25def719-c5a7-43c5-95ca-9e2e09493e54.png" alt="Map" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md10"></a>
Collectable Generator Example</h1>
<div class="fragment"><div class="line">{CollectableGenerator.cs} </div>
<div class="line">var seed = new RandomSeed(12345);</div>
<div class="line">var generator = new CollectableGenerator();</div>
<div class="line"> </div>
<div class="line">// Add collectable ID&#39;s to groups. Multiple ID&#39;s may be added for the same item.</div>
<div class="line">// These groups will also need to be assigned to some room template cells.</div>
<div class="line">var collectableGroups = new CollectableGroups();</div>
<div class="line">collectableGroups.Add(&quot;Group1&quot;, 1, 1, 1, 2, 3, 4, 5);</div>
<div class="line">collectableGroups.Add(&quot;Group2&quot;, 6, 7, 7, 8, 8, 9, 10);</div>
<div class="line"> </div>
<div class="line">generator.Generate(layout, collectableGroups, seed);</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md11"></a>
Generation Pipeline Example</h1>
<div class="fragment"><div class="line">{GeneratorPipeline.cs} </div>
<div class="line">// Create a dictionary of arguments to be passed to each pipeline step.</div>
<div class="line">var args = new Dictionary&lt;string, object&gt;</div>
<div class="line">{</div>
<div class="line">    { &quot;LayoutId&quot;, 1 },</div>
<div class="line">    { &quot;LayoutGraph&quot;, graph },</div>
<div class="line">    { &quot;TemplateGroups&quot;, templateGroups },</div>
<div class="line">    { &quot;CollectableGroups&quot;, collectableGroups },</div>
<div class="line">    { &quot;RandomSeed&quot;, seed },</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">// Use the default pipeline</div>
<div class="line">var pipeline = GenerationPipeline.CreateDefaultPipeline();</div>
<div class="line"> </div>
<div class="line">// Or create your own</div>
<div class="line">pipeline = new GenerationPipeline(new LayoutGenerator(), new CollectableGenerator());</div>
<div class="line"> </div>
<div class="line">var results = pipeline.Generate(args);</div>
<div class="line">var layout = (Layout)results[&quot;Layout&quot;];</div>
</div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
